# Getting Started

Rise4fun leverages Docusaurus 2.0 (`2.2.0`) along with a few custom plugins.

In this page, we'll show you how to create your first Docusaurus web site and
enable the rise4fun plugins in it.

## Docusaurus

[Docusaurus](https://docusaurus.io/) is a framework to build optimized documentation web sites.
It has an extensive documentation which we recommend taking a peek later on. For simplicity,
the installation tutorial is repeated here:

Install [Node.js](https://nodejs.org/en/download/) and [yarn](https://yarnpkg.com/), open a terminal on your project root
and create a new Docusaurus site:

```bash
npm install -g yarn
npx create-docusaurus@latest website classic
```

## Rise4fun plugins

Install the rise4fun plugin.

```bash npm2yarn
npm install @rise4fun/docusaurus-plugin-rise4fun
```

Open `website/docusaurus.config.js` and update it as follows.

```js title="website/docusaurus.config.js"
// highlight-next-line
const { configure } = require("docusaurus-plugin-rise4fun");

/** @type {import('@docusaurus/types').Config} */
// highlight-next-line
const config = configure(
    {
        ...
}
// highlight-start
    // rise4fun configuration
    , {

})
// highlight-end
```

## Start authoring!

Start the site

```bash
cd website
yarn start
```

Open [http://localhost:3000](http://localhost:3000) and you'll see your web site running, yay!

## Configuring...

Rise4fun enables various plugins and features automatically:

-   Microsoft legal links (disable with `legal: false`)
-   [math rendering](https://docusaurus.io/docs/markdown-features/math-equations) (disable with `math: false`)
-   [npm + yarn tab snippets](https://docusaurus.io/docs/markdown-features/code-blocks#npm2yarn-remark-plugin) (disable with `npm2yarn: false`)
-   [diagrams](https://docusaurus.io/docs/markdown-features/diagrams) (disable with `mermaid: false`)

We'll see in the next section how to enable more features.

:::tip

Restart the develpment web server after modifying `docusaurus.config.js`.

:::

### Analytics with Application Insights

You can track page views using Microsoft Application Insights analytics in the deployed web site.
There are many other analytics platforms supported by Docusaurus through other [plugins](https://docusaurus.io/docs/next/api/plugins).

Insert your [application insights web configuration](https://github.com/microsoft/ApplicationInsights-JS#snippet-configuration-options) in the `docusaurus.config.js` file with, at least,
the `instrumentationKey`. **By default, cookies are disabled.**

```js title="website/docusaurus.config.js"
...
const config = configure({ ... }, {
// highlight-start
    appInsights: {
        instrumentationKey: "YOUR KEY HERE"
    }
// highlight-end
})
```

### Compile code

The next configuration allows to extract code snippets and run them through your tool at build time, then insert the
output in the generated web site. As long as your tool can run in a GitHub Action container, this feature allows to easily
inline the output of your tool.

```js title="website/docusaurus.config.js"
...
const config = configure({ ... }, {
// highlight-start
    compileCode: {
        langs: [{
            lang: "...",
            ...
        }, ...]
    }
// highlight-end
})
```

#### Tools published on npm

Let's take the TypeScript compiler as an example. First, start by adding `typescript` to your project

```basn npm2yarn
yarn add typescript
```

then add a `compileCode` language entry that will run all `ts` code section through the `tsc` node executable.

```js title="website/docusaurus.config.js"
compileCode: {
    langs: [
        // highlight-start
        {
            lang: "ts",
            nodeBin: "tsc",
        },
        // highlight-end
    ];
}
```

Let's take a look at this example in action.

````markdown
    ```ts showLineNumbers
    console.llog("typo!")
    ```
````

When rendered in the docs, this snippet looks like any other code snippe. But you'll also notice an additional box
underneath with the TypeScript compiler output. This output was computed at build time.

```ts showLineNumbers
console.llog("typo!");
```

#### Custom tool

To support custom scenario, you can provide a `compile` function
and wire it up as you please.

In this example, we create a `echo` tool that copies the capitalized input source
into the output.

```js title="website/docusaurus.config.js"
    compileCode: {
        langs: [
        ...,
// highlight-start
        {
            lang: "echo",
            compile: (source, langOptions) => ({
                code: 0,
                stdout: source.toUppercase(),
            }),
        }
// highlight-end
    ]}
```

Let's take a look at this example in action.

````markdown
    ```echo
    hello
    ```
````

When rendered in the docs, this snippet looks like any other code snippe.
But you'll also notice an additional box
underneath with the capitalized text.

```echo
hello
```

## GitHub Actions

Now that you've got the website building locally, it's time to setup a build script in GitHub Actions
to prepare for automatic deployment.

Add a root level `package.json` file that declares the `website` folder as a `yarn` workspace (and the `packages` folder).

```json title="package.json"
{
    "private": true,
    "workspaces": ["packages/*", "website"],
    "scripts": {
        "build": "cd website && yarn build"
    }
}
```

Add `.github/workflows/build.yml` to your project

```yml title=".github/workflows/build.yml"
name: Build and Deploy
on:
    workflow_dispatch:
    push:
    pull_request:
jobs:
    build:
        name: Build and Deployment
        runs-on: ubuntu-latest
        env:
            GITHUB_REPOSITORY: ${{ github.repository }}
            GITHUB_REF: ${{ github.ref }}
            GITHUB_SHA: ${{ github.sha }}
        steps:
            - uses: actions/checkout@v3

            - uses: actions/setup-node@v3
              with:
                  node-version: 18.x
                  cache: yarn
                  cache-dependency-path: yarn.lock

            - name: yarn install
              run: yarn install --frozen-lockfile

            - name: Build all
              run: yarn build

            - name: Deploy to GitHub Pages
              uses: peaceiris/actions-gh-pages@v3
              if: ${{ github.ref == 'refs/heads/main' }}
              with:
                  github_token: ${{ secrets.GITHUB_TOKEN }}
                  publish_dir: website/build
```
